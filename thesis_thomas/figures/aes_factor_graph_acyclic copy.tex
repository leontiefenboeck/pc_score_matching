\begin{tikzpicture}
    % 1st row
    \node[latent] (k1) {$k_1$} ; %
    \node[obs, below=0.3cm of k1] (p1) {$p_1$} ; %
    \factor[right=0.5cm of k1, yshift=-0.45cm] {kp1_xor} {below:$\textsc{xor}$} {} {}; %
    \factoredge {k1, p1} {kp1_xor} {} ; %
    \node[latent, right=0.5cm of kp1_xor] (y1) {$y_1$} ; %
    \factor[right=0.5cm of y1] {s1} {below:$\textsc{s}$} {} {}; %
    \factoredge {y1} {kp1_xor, s1} {} ; %
    \node[latent, right=0.5cm of s1] (x1) {$x_1$} ; %
    \factoredge {x1} {s1} {} ; %
    
    % 2nd row
    \node[latent, below=0.3cm of p1] (k2) {$k_2$} ; %
    \node[obs, below=0.3cm of k2] (p2) {$p_2$} ; %
    \factor[right=0.5cm of k2, yshift=-0.45cm] {kp2_xor} {below:$\textsc{xor}$} {} {}; %
    \factoredge {k2, p2} {kp2_xor} {} ; %
    \node[latent, right=0.5cm of kp2_xor] (y2) {$y_2$} ; %
    \factor[right=0.5cm of y2] {s2} {below:$\textsc{s}$} {} {}; %
    \factoredge {y2} {kp2_xor, s2} {} ; %
    \node[latent, right=0.5cm of s2] (x2) {$x_2$} ; %
    \factoredge {x2} {s2} {} ; %
    
    % 3rd row
    \node[latent, below=0.3cm of p2] (k3) {$k_3$} ; %
    \node[obs, below=0.3cm of k3] (p3) {$p_3$} ; %
    \factor[right=0.5cm of k3, yshift=-0.45cm] {kp3_xor} {below:$\textsc{xor}$} {} {}; %
    \factoredge {k3, p3} {kp3_xor} {} ; %
    \node[latent, right=0.5cm of kp3_xor] (y3) {$y_3$} ; %
    \factor[right=0.5cm of y3] {s3} {below:$\textsc{s}$} {} {}; %
    \factoredge {y3} {kp3_xor, s3} {} ; %
    \node[latent, right=0.5cm of s3] (x3) {$x_3$} ; %
    \factoredge {x3} {s3} {} ; %
    
    % 4th row
    \node[latent, below=0.3cm of p3] (k4) {$k_4$} ; %
    \node[obs, below=0.3cm of k4] (p4) {$p_4$} ; %
    \factor[right=0.5cm of k4, yshift=-0.45cm] {kp4_xor} {below:$\textsc{xor}$} {} {}; %
    \factoredge {k4, p4} {kp4_xor} {} ; %
    \node[latent, right=0.5cm of kp4_xor] (y4) {$y_4$} ; %
    \factor[right=0.5cm of y4] {s4} {below:$\textsc{s}$} {} {}; %
    \factoredge {y4} {kp4_xor, s4} {} ; %
    \node[latent, right=0.5cm of s4] (x4) {$x_4$} ; %
    \factoredge {x4} {s4} {} ; %
    
    \factor[right=1.25cm of x2, yshift=-0.95cm] {pc} {right:$\mathcal{M}_B$} {} {}; %
    
    \node[latent, right=3cm of x4] (x4m) {$x_4^{(m)}$} ; %
    \node[latent, above=1cm of x4m] (x3m) {$x_3^{(m)}$} ; %
    \node[latent, above=1.3cm of x3m] (x2m) {$x_2^{(m)}$} ; %
    \node[latent, above=1cm of x2m] (x1m) {$x_1^{(m)}$} ; %
    
    \factoredge {x1, x2, x3, x4, x1m, x2m, x3m, x4m} {pc} {} ; %
\end{tikzpicture}