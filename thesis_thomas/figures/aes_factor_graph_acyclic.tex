\begin{tikzpicture}
    % 1st row
    \node[latent] (k1) {$k_i$} ; %
    \factor[above=0.25cm of k1] {pk1} {above:$p(k_i|\leak)$} {} {}; %
    \factoredge {k1} {pk1} {} ; %
    \node[obs, below=0.3cm of k1] (p1) {$p_i$} ; %
    \factor[right=0.5cm of k1, yshift=-0.45cm] {kp1_xor} {below:$\textsc{xor}$} {} {}; %
    \factoredge {k1, p1} {kp1_xor} {} ; %
    \node[latent, right=0.5cm of kp1_xor] (y1) {$y_i$} ; %
    \factor[right=0.5cm of y1] {s1} {below:$\textsc{s}$} {} {}; %
    \factor[above=0.25cm of y1] {py1} {above:$p(y_i|\leak)$} {} {}; %
    \factoredge {y1} {kp1_xor, s1, py1} {} ; %
    \node[latent, right=0.5cm of s1] (x1) {$x_i$} ; %
    \factor[above=0.25cm of x1] {px1} {above:$p(x_i|\leak)$} {} {}; %
    \factoredge {x1} {s1, px1} {} ; %


    \factor[right=1.25cm of x1] {pc} {below:$\mathcal{M}_B$} {} {}; %

    \node[latent, right=1cm of pc, yshift=1.40cm] (x1m) {$x_i^{(m)}$} ; %
    \factor[right=0.75cm of x1m] {px1m} {above:$p(x_i^{(m)}|\leak)$} {} {}; %
    \factoredge {x1m} {px1m} {} ; %

    \node[latent, below=1.4cm of x1m] (zi) {$v_i$} ; %
    \factor[right=0.75cm of zi] {pzi} {above:$p(v_i|\leak)$} {} {}; %
    \factoredge {zi} {pzi} {} ; %

    \plate {} {(zi)(pzi)(pzi-caption)} {$v_i \in \mathbf{v}_{\mathit{mid}}$} ; %
    \plate {} {(p1)(px1)(px1-caption)(pk1)(pk1-caption)} {$1 \leq i \leq 4$} ; %
    \plate {} {(x1m)(px1m)(px1m-caption)} {$1 \leq i \leq 4$} ; %

    \factoredge {x1, x1m, zi} {pc} {} ; %
\end{tikzpicture}

