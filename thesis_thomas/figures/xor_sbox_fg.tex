\begin{tikzpicture}
    \factor[] {xor} {below:$\textsc{xor}$} {} {};
    \factor[right=2.5 of xor] {sbox} {below:$\textsc{sbox}$} {} {};

    \node[latent, above=of xor, xshift=-1.7cm] (k) {$k$} ; %
    \node[obs, right=1 of k] (p) {$p$} ; %
    \node[latent, right=1 of p] (y) {$y$} ; %
    \node[latent, right=1 of y] (x) {$x$} ; %
    \factoredge {k,p,y} {xor} {} ; %
    \factoredge {y,x} {sbox} {} ; %

    \factor[above=of k] {pk} {above:$p(k | \leak)$} {} {};
    \factor[above=of y] {py} {above:$p(y | \leak)$} {} {};
    \factor[above=of x] {px} {above:$p(x | \leak)$} {} {};

    \factoredge {k} {pk} {} ; %
    \factoredge {y} {py} {} ; %
    \factoredge {x} {px} {} ; %

\end{tikzpicture}
